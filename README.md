# Ассемблер УВМ - Вариант 18

## Этап 1: Перевод программы в промежуточное представление

### Описание

CLI-приложение ассемблера для учебной виртуальной машины (УВМ).
Реализует разбор текстового представления команд на языке JSON и трансляцию в промежуточное представление.

### Спецификация УВМ (Вариант 18)

| Команда | Код (A) | Поле B | Поле C | Описание |
|---------|---------|--------|--------|----------|
| load_const | 39 | Константа (биты 6-15) | Адрес (биты 16-27) | Загрузка константы в память |
| read_mem | 30 | Адрес источника (биты 6-17) | Адрес назначения (биты 18-29) | Чтение из памяти |
| write_mem | 22 | Адрес источника (биты 6-17) | Адрес назначения (биты 18-29) | Запись в память |
| popcnt | 61 | Адрес источника (биты 6-17) | Адрес результата (биты 18-29) | Подсчет единичных битов |

### Язык ассемблера (формат JSON)

Программа представляет собой JSON-массив команд:

```json
[
    {"op": "load_const", "const": 181, "addr": 980},
    {"op": "read_mem", "src": 683, "dst": 871},
    {"op": "write_mem", "src": 77, "dst": 895},
    {"op": "popcnt", "src": 1022, "dst": 6}
]
```

#### Команды:

1. **load_const** - загрузка константы в память
   - `const` - значение константы
   - `addr` - адрес в памяти

2. **read_mem** - чтение значения из памяти
   - `src` - адрес источника
   - `dst` - адрес назначения

3. **write_mem** - запись значения в память
   - `src` - адрес источника
   - `dst` - адрес назначения

4. **popcnt** - подсчет единичных битов
   - `src` - адрес операнда
   - `dst` - адрес результата

### Запуск ассемблера

```bash
python assembler.py <входной_файл> <выходной_файл> [--test]
```

**Аргументы:**
- `входной_файл` - путь к файлу с программой на языке ассемблера (JSON)
- `выходной_файл` - путь к файлу для сохранения промежуточного представления
- `--test` - режим тестирования (вывод промежуточного представления на экран)

**Примеры:**

```bash
# Обычный режим
python assembler.py test_program.json output.json

# Режим тестирования
python assembler.py test_program.json output.json --test
```

### Запуск тестов

```bash
python test_assembler.py
```

### Тесты из спецификации УВМ

| Команда | Параметры | Промежуточное представление |
|---------|-----------|----------------------------|
| load_const | const=181, addr=980 | A=39, B=181, C=980 |
| read_mem | src=683, dst=871 | A=30, B=683, C=871 |
| write_mem | src=77, dst=895 | A=22, B=77, C=895 |
| popcnt | src=1022, dst=6 | A=61, B=1022, C=6 |

### Структура проекта

```
3practika/
├── assembler.py      # Ассемблер (Этап 1)
├── test_assembler.py # Тесты
├── test_program.json # Тестовая программа
└── README.md         # Документация
```

